import{c as m,u as S,r,j as t}from"./index-BSuvrgVz.js";/* empty css                   */import{S as C}from"./send-CCZamJb-.js";const U=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],E=m("camera",U);const I=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],T=m("image",I);const R=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],H=m("user",R);const _=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],z=m("users",_);function A(){const{t:n}=S("app"),[c,p]=r.useState("supervisor"),[d,g]=r.useState(""),[o,i]=r.useState([]),[l,x]=r.useState(!1),v=r.useRef(null),h=r.useRef(null);r.useEffect(()=>{i(c==="supervisor"?[{id:"1",sender:"other",senderName:"Hr. Schmidt",text:"Guten Morgen! Wie kann ich Ihnen helfen?",timestamp:new Date(Date.now()-36e5)},{id:"2",sender:"user",text:"Ich hätte eine Frage zum Dienstplan nächste Woche.",timestamp:new Date(Date.now()-3e6)}]:[{id:"1",sender:"other",senderName:"Maria",text:"Hallo Team! Wer kann morgen die Schicht übernehmen?",timestamp:new Date(Date.now()-72e5)},{id:"2",sender:"other",senderName:"Thomas",text:"Ich könnte ab 14 Uhr einspringen.",timestamp:new Date(Date.now()-54e5)}])},[c]),r.useEffect(()=>{j()},[o]),r.useEffect(()=>{const e=document.querySelector(".chat-input");if(!e)return;const a=()=>{setTimeout(()=>{h.current?.scrollIntoView({behavior:"smooth",block:"end"})},300)};return e.addEventListener("focus",a),()=>{e.removeEventListener("focus",a)}},[]);const j=()=>{h.current?.scrollIntoView({behavior:"smooth"})},f=()=>{if(!d.trim())return;const e={id:Date.now().toString(),sender:"user",text:d,timestamp:new Date};i([...o,e]),g(""),setTimeout(()=>{const a={id:(Date.now()+1).toString(),sender:"other",senderName:c==="supervisor"?"Hr. Schmidt":"Team Mitglied",text:n("chat.autoResponse"),timestamp:new Date};i(s=>[...s,a])},2e3)},N=e=>{e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),f())},w=e=>{const a=e.target.files?.[0];if(!a)return;x(!0);const s=new FileReader;s.onload=()=>{const y={id:Date.now().toString(),sender:"user",text:"",imageUrl:s.result,timestamp:new Date};i([...o,y]),x(!1)},s.readAsDataURL(a)},k=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert(n("chat.cameraNotSupported"));return}const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),a=document.createElement("video");a.srcObject=e,a.play(),await new Promise(u=>{a.onloadedmetadata=u});const s=document.createElement("canvas");s.width=a.videoWidth,s.height=a.videoHeight,s.getContext("2d")?.drawImage(a,0,0),e.getTracks().forEach(u=>u.stop());const D=s.toDataURL("image/jpeg"),M={id:Date.now().toString(),sender:"user",text:"",imageUrl:D,timestamp:new Date};i([...o,M])}catch(e){console.error("Camera error:",e),alert(n("chat.cameraError"))}},b=e=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"page-container chat-page-container",children:[t.jsx("header",{className:"page-header",children:t.jsx("h1",{className:"page-title",children:n("chat.title")})}),t.jsxs("div",{className:"chat-container",children:[t.jsxs("div",{className:"chat-tabs",children:[t.jsxs("button",{type:"button",className:`chat-tab ${c==="supervisor"?"active":""}`,onClick:()=>p("supervisor"),children:[t.jsx(H,{size:18}),t.jsx("span",{children:n("chat.supervisor")})]}),t.jsxs("button",{type:"button",className:`chat-tab ${c==="team"?"active":""}`,onClick:()=>p("team"),children:[t.jsx(z,{size:18}),t.jsx("span",{children:n("chat.team")})]})]}),t.jsxs("div",{className:"messages-container",children:[o.map(e=>t.jsxs("div",{className:`message ${e.sender==="user"?"message-user":"message-other"}`,children:[e.sender==="other"&&e.senderName&&t.jsx("div",{className:"message-sender",children:e.senderName}),e.imageUrl&&t.jsx("img",{src:e.imageUrl,alt:"Uploaded",className:"message-image"}),e.text&&t.jsx("div",{className:"message-text",children:e.text}),t.jsx("div",{className:"message-time",children:b(e.timestamp)})]},e.id)),t.jsx("div",{ref:h})]}),t.jsxs("div",{className:"chat-input-container",children:[t.jsx("button",{type:"button",className:"chat-action-button",onClick:()=>v.current?.click(),disabled:l,title:n("chat.uploadImage"),children:t.jsx(T,{size:20})}),t.jsx("button",{type:"button",className:"chat-action-button",onClick:k,disabled:l,title:n("chat.takePhoto"),children:t.jsx(E,{size:20})}),t.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:w,style:{display:"none"}}),t.jsx("input",{type:"text",value:d,onChange:e=>g(e.target.value),onKeyPress:N,placeholder:n("chat.messagePlaceholder"),className:"chat-input",disabled:l}),t.jsx("button",{type:"button",className:"chat-send-button",onClick:f,disabled:!d.trim()||l,children:t.jsx(C,{size:20})})]})]})]})}export{A as default};
